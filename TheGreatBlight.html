<tw-storydata name="TheGreatBlight" startnode="1" creator="Twine" creator-version="2.2.1" ifid="7E85DFA1-8BE1-44D1-AF8F-254142380840" zoom="1" format="Snowman" format-version="1.3.0" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">


</style><script role="script" id="twine-user-script" type="text/twine-javascript">//Global variables
story.state.currFrame = null;

//Initialize inventory to empty
story.state.inventory = {};

//functions for manipulating the inventory
story.state.inventory_add = function(id, name, desc, count){
	count = count || 1; //optional param, if not defined set to 1
	if(id in story.state.inventory){
		story.state.inventory[id] += count;
	}else{
		story.state.inventory[id] = {id:id, name:name, desc:desc, count:count };
	}
	return true;
}

//count is optionial, checks to see if count # if items in inventory
story.state.inventory_has = function(id, count){
	count = count || 1; //optional param, if not defined set to 1
	if(id in story.state.inventory){
		return story.state.inventory[id].count >= count;
	}
	return false;
}

//count is optional, defaults to 1
story.state.inventory_remove = function(id, count){
	count = count || 1; //optional param, if not defined set to 1
	if(id in story.state.inventory && story.state.inventory[id].count >= count){
		story.state.inventory[id].count -= count;
		if(story.state.inventory[id].count == 0){
			delete story.state.inventory[id];
		}
		return true;
	}no-inventory
	return false;
}



//Misc Helper functions

//Need to evaluate this.passage at runtime
window.getPassage = function(){
	return this.passage;
}

story.state.generateLink = function(pname,txt){ 
  return "<a onclick='story.show(\"" + pname + "\");'>" + txt + "</a>"; 
}



//Stuff to run after every passage renders
$(window).on('showpassage:after', function(){   
	var passage = window.getPassage();
	
	//Saveframe & load inv links if 'no-inventory' not present
	if(!passage.tags.includes('no-inventory')){
    story.state.currFrame = window.getPassage().name;
        var rs = "==============================================="  
        rs += "<br/>";
        rs += "<a onclick='story.show(\"Inventory\");'>"
        rs += "Inventory</a><br/>";
        $('#passage').append(rs);
    }
});


//Preload inventory
story.state.inventory_add('pocketlint','Pocket lint','It\'s small and fuzzy',3);
</script><tw-passagedata pid="1" name="StartingOff" tags="" position="412,187" size="100,100">&lt;em&gt;
Greetings Friend,

I hope this letter finds you well. Our endeavors have progressed quickly, and we have need of your time and talents. We&#39;ll be waiting.

Yours truly,
T.H. Renoux
&lt;/em&gt;

Tucked into the folds of the letter, you find a small, brass key. &lt;% s.inventory_add(&#39;sbrasskey&#39;,&#39;Small brass key&#39;,&#39;It\&#39;s a small brass key&#39;) %&gt;

[[Burn the letter]]

[[Eat the letter]]

[[Return to the Kitchen]]</tw-passagedata><tw-passagedata pid="2" name="Burn the letter" tags="" position="262,337" size="100,100">This is clearly junk mail. With a snap of your fingers, the letter bursts into flames. You start to turn away, but then you see the faint outline of a mouth form from the letters ashes. It sounds like a screaming child, but the words are the same as the contents of the letter. Junk mailers wouldn&#39;t spring for a minor god, I guess Renoux really did send you a letter.

[[Return to the Kitchen]]
</tw-passagedata><tw-passagedata pid="3" name="Eat the letter" tags="" position="409,337" size="100,100">You take out your normal human teeth and attach your paper shredding teeth. Between bites you reflect that the letter has a velvety texture with undertones of cinnamon and sadness.

The letter is eaten.

[[Return to the kitchen -&gt;Return to the Kitchen]] 
[[Eat the table -&gt;Eat Table]]
[[Digest the letter]]</tw-passagedata><tw-passagedata pid="4" name="Return to the Kitchen" tags="" position="193,199" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="5" name="Eat Table" tags="" position="337,487" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="6" name="Digest the letter" tags="" position="487,487" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="7" name="Inventory" tags="no-inventory" position="410,35" size="100,100">### Inventory

&lt;% 
if(s.inventory.length == 0){
	print(&quot;Nothing! You have absolutely nothing!&quot;);
}

for(var itemid in s.inventory){
    var item = s.inventory[itemid];
	var countTxt = &quot;&quot;;
	if(item.count &gt; 1){
		countTxt = &quot;(&quot; + parseInt(item.count) + &quot;x)&quot;;
	}

	var ps = item.name + countTxt + &quot; : &quot; + item.desc;
	print(ps + &quot;&lt;br/&gt;&quot;);
} 

%&gt;


&lt;%= s.generateLink(s.currFrame, &quot;Return to story&quot;) %&gt;</tw-passagedata></tw-storydata>